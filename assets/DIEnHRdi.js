import{p as I,u as M,a as m,r as P,s as T,t as B,g as O,o as U,b as S,w as R,c as x,d as V,e as q,f as j,h as E,i as N,j as k,k as z,l as H,m as b,n as A,q as $,v as h,x as F,y as K}from"./CBE65D-j.js";const J=I("/odixApp.svg"),L=I("/appstore.png"),G=s=>s==="defer"||s===!1;function Q(...s){var p;const n=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(n);let[a,d,e={}]=s;if(typeof a!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof d!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const t=M(),v=d,o=()=>m.value,D=()=>t.isHydrating?t.payload.data[a]:t.static.data[a];e.server??(e.server=!0),e.default??(e.default=o),e.getCachedData??(e.getCachedData=D),e.lazy??(e.lazy=!1),e.immediate??(e.immediate=!0),e.deep??(e.deep=m.deep),e.dedupe??(e.dedupe="cancel");const y=e.getCachedData(a,t),g=y!=null;if(!t._asyncData[a]||!e.immediate){(p=t.payload._errors)[a]??(p[a]=m.errorValue);const c=e.deep?P:T;t._asyncData[a]={data:c(g?y:e.default()),pending:P(!g),error:B(t.payload._errors,a),status:P("idle"),_default:e.default}}const r={...t._asyncData[a]};delete r._default,r.refresh=r.execute=(c={})=>{if(t._asyncDataPromises[a]){if(G(c.dedupe??e.dedupe))return t._asyncDataPromises[a];t._asyncDataPromises[a].cancelled=!0}if(c._initial||t.isHydrating&&c._initial!==!1){const l=c._initial?y:e.getCachedData(a,t);if(l!=null)return Promise.resolve(l)}r.pending.value=!0,r.status.value="pending";const u=new Promise((l,i)=>{try{l(v(t))}catch(C){i(C)}}).then(async l=>{if(u.cancelled)return t._asyncDataPromises[a];let i=l;e.transform&&(i=await e.transform(l)),e.pick&&(i=X(i,e.pick)),t.payload.data[a]=i,r.data.value=i,r.error.value=m.errorValue,r.status.value="success"}).catch(l=>{if(u.cancelled)return t._asyncDataPromises[a];r.error.value=q(l),r.data.value=j(e.default()),r.status.value="error"}).finally(()=>{u.cancelled||(r.pending.value=!1,delete t._asyncDataPromises[a])});return t._asyncDataPromises[a]=u,t._asyncDataPromises[a]},r.clear=()=>W(t,a);const w=()=>r.refresh({_initial:!0}),_=e.server!==!1&&t.payload.serverRendered;{const c=O();if(c&&_&&e.immediate&&!c.sp&&(c.sp=[]),c&&!c._nuxtOnBeforeMountCbs){c._nuxtOnBeforeMountCbs=[];const i=c._nuxtOnBeforeMountCbs;U(()=>{i.forEach(C=>{C()}),i.splice(0,i.length)}),S(()=>i.splice(0,i.length))}_&&t.isHydrating&&(r.error.value||y!=null)?(r.pending.value=!1,r.status.value=r.error.value?"error":"success"):c&&(t.payload.serverRendered&&t.isHydrating||e.lazy)&&e.immediate?c._nuxtOnBeforeMountCbs.push(w):e.immediate&&w();const u=V();if(e.watch){const i=R(e.watch,()=>r.refresh());u&&x(i)}const l=t.hook("app:data:refresh",async i=>{(!i||i.includes(a))&&await r.refresh()});u&&x(l)}const f=Promise.resolve(t._asyncDataPromises[a]).then(()=>r);return Object.assign(f,r),f}function W(s,n){n in s.payload.data&&(s.payload.data[n]=void 0),n in s.payload._errors&&(s.payload._errors[n]=m.errorValue),s._asyncData[n]&&(s._asyncData[n].data.value=void 0,s._asyncData[n].error.value=m.errorValue,s._asyncData[n].pending.value=!1,s._asyncData[n].status.value="idle"),n in s._asyncDataPromises&&(s._asyncDataPromises[n]&&(s._asyncDataPromises[n].cancelled=!0),s._asyncDataPromises[n]=void 0)}function X(s,n){const a={};for(const d of n)a[d]=s[d];return a}function Y(s){return{}}const Z={class:"flex flex-col items-center justify-center"},ae=E({__name:"index",async setup(s){let n,a;const{$uaParser:d}=M(),e=N(),t=F();let v;const o=k({userAgent:"",ipAddress:"",clickTime:"",deviceInfo:{},userId:""}),{data:D,status:y,error:g,refresh:r,clear:w}=([n,a]=z(()=>Q("mountains",()=>$fetch("/api/ping",{headers:Y()}))),n=await n,a(),n);o.ipAddress=D.value.address;const _=async()=>{try{const f=await $fetch(t.public.apiUrl,{credentials:"omit",mode:"cors",method:"POST",body:JSON.stringify({ip:o.ipAddress,referralCode:e.query.code||"",userAgent:o.userAgent,clickTime:o.clickTime,deviceSpecs:o.deviceInfo,inviterId:e.query.id||"",deviceId:o.userId,deviceModel:o.deviceInfo.deviceModel,deviceBrand:o.deviceInfo.deviceVendor}),headers:{"Content-Type":"application/json"}});v=setTimeout(()=>{K("https://apps.apple.com/us/app/odixpay-crypto-wallet-card/id6736972556",{external:!0})},3e3)}catch(f){return b({statusCode:f.statusCode,statusMessage:"Something went wrong"})}};return H(async()=>{if(!e.query.id||!e.query.code)return b({statusCode:404,statusMessage:"Not Found"});o.userAgent=navigator.userAgent,o.clickTime=new Date().toISOString(),o.userId=e.query.id,o.deviceInfo={deviceType:d.device.type||"Desktop",deviceVendor:d.device.vendor||"Unknown Vendor",deviceModel:d.device.model||"Unknown Model",os:d.os.name+"__"+d.os.version||"Unknown OS",browserName:d.browser.name||"Unknown Browser",cpu:d.cpu.architecture||"Unknown CPU"},await _()}),S(()=>{clearTimeout(v)}),(f,p)=>($(),A("div",Z,p[0]||(p[0]=[h("div",{class:"flex items-center justify-center mb-4 space-x-[-32px] drop-shadow-md"},[h("img",{src:J,class:"size-[74px]"}),h("img",{class:"size-[74px]",src:L,alt:""})],-1),h("h1",{class:"text-xl font-[300] text-gray-800 text-center capitalize loading mx-auto relative"},"Redirecting to AppStore",-1)])))}});export{ae as default};
